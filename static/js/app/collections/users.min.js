define(["jquery","underscore","backbone","app/models/user-profile"],function(c,a,e,b){var d=e.Collection.extend({url:"friends.get",model:b,initialize:function(){this.collectionModel=new (e.Model.extend());this.collectionModel.set({fields:["nickname","sex","bdate","photo_50","online","status","can_see_audio","online"]},{silent:true});this.collectionModel.bind("change",this.fetch,this);this.setElement(this.at(0))},searchByName:function(g){g=g.split(" ").join("").toLocaleLowerCase();if(!g){return false}var f=a.filter(this.models,function(k){var l=k.get("first_name");var i=k.get("last_name");var h=k.get("user_id");var m=l+i+h;m=m.split(" ").join("").toLocaleLowerCase();var j=m.indexOf(g);if(j>=0){return true}});return f},fetch:function(){var f=this;var g=this.collectionModel.toJSON();VK.Api.call(this.url,g,function(i){if(i&&i.response){var h=a.filter(i.response,function(j){return j.can_see_audio},f);f.reset(h);f.setElement(f.at(0))}else{alert(i.error.error_msg);f.reset([])}})}});return d});