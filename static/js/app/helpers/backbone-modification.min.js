define(["jquery","underscore","backbone"],function(d,b,e){var a=e.View.prototype.remove;e.View.prototype.remove=function(){if(this.nodes){for(var f in this.nodes){if(f.indexOf("$")>=0){this.nodes[f].remove()}}}if(this.children){for(var g in this.children){if(this.children[g].remove){this.children[g].remove()}}}return a.call(this,arguments)};var c=e.Collection.prototype.initialize;e.Collection.prototype.initialize=function(){this.setElement(this.at(0));return c.call(this,arguments)};e.Collection.prototype.getElement=function(){return this.currentElement};e.Collection.prototype.setElement=function(f){this.currentElement=f};e.Collection.prototype.next=function(){this.setElement(this.at(this.indexOf(this.getElement())+1));return this};e.Collection.prototype.prev=function(){this.setElement(this.at(this.indexOf(this.getElement())-1));return this};e.Collection.prototype.cache={};e.Collection.prototype.cache.items=[];e.Collection.prototype.cache.get=function(g){g=b.pick(g,"owner_id");var f=b.find(this.items,function(h){return parseInt(g.owner_id)==parseInt(h.data.owner_id)});if(!f){return false}return f.items};e.Collection.prototype.cache.save=function(f){data=b.pick(f.data,"owner_id");if(this.get(data)){return this.update(f)}f.data=data;return this.items.push(f)};e.Collection.prototype.cache.update=function(h){data=b.pick(h.data,"owner_id");var g=this.get(data);var f=h.items;return b.map(f,function(j){var i=b.findWhere(g,{aid:j.aid,owner_id:j.owner_id});if(i){b.extend(i,j)}return j})}});