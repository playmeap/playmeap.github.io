define(["jquery","underscore","backbone","text!templates/audios/list-item-favorite.html"],function(d,b,e,a){var c=e.View.extend({tagName:"li",className:"col-sm-12 audioListItem disable",events:{"click .favorite":"removeToFavorite","click .play":"playItem","click .pause":"pauseItem","click .progress":"rewind"},initialize:function(){this.model.collection.bind("remove",function(i){if(i.cid==this.model.cid){this.remove()}},this);var h=function(){this.el.querySelector(".playcontrol").classList.add("glyphicon-pause","pause");this.el.querySelector(".playcontrol").classList.remove("glyphicon-play","play")}.bind(this);var f=function(){this.el.querySelector(".playcontrol").classList.remove("glyphicon-pause","pause");this.el.querySelector(".playcontrol").classList.add("glyphicon-play","play")}.bind(this);var g=function(){this.el.querySelector(".playcontrol").classList.remove("glyphicon-pause","pause");this.el.querySelector(".playcontrol").classList.add("glyphicon-play","play")}.bind(this);this.$el.on("play",h);this.$el.on("stop",f);this.$el.on("pause",g)},playItem:function(){this.app.views.playerController.play(this.model.get("aid"))},pauseItem:function(){this.app.views.playerController.pause(this.model)},rewind:function(i){var f=i.offsetX==undefined?i.layerX:i.offsetX;var g=this.$nodeProgress.width();var h=f/g*100;this.app.views.playerController.rewind(h)},removeToFavorite:function(){var f=this;var g={};g.mid=this.app.attributes.mid;g.album_id=0;g.audio_ids=[this.model.get("aid")];VK.Api.call("audio.moveToAlbum",g,function(h){if(h&&h.response){f.app.collections.audioFavorites.add(f.model);f.model.collection.remove(f.model)}})},render:function(){var f=this.model.toJSON();this.el.innerHTML=b.template(a)(f);this.$el.addClass("audio_item audio_"+f.aid);this.nodeProgress=this.el.querySelector(".progress");this.$nodeProgress=d(this.nodeProgress);return this}});return c});