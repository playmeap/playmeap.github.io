define(["underscore","backbone"],function(a,c){var b=c.Collection.extend({options:{user_id:0,fields:["photo_50","can_see_audio","status"]},initialize:function(d){if(!d||!d.user_id){alert("error init collection");this.app.log({msg:"error init collection",data:d});return false}this.options=a.extend(this.options,d);this.bind("reset",function(){this.setElement(this.at(0))},this);this.loadData()},getElement:function(){return this.currentElement},setElement:function(d){this.currentElement=d},next:function(){this.setElement(this.at(this.indexOf(this.getElement())+1));return this},prev:function(){this.setElement(this.at(this.indexOf(this.getElement())-1));return this},loadData:function(f){var d=this;var e=this.options;VK.Api.call("friends.get",e,function(h){if(h&&h.response){var g=a.where(h.response,{can_see_audio:1});d.reset(g);if(f){f(true)}}else{alert(h.error.error_msg);d.reset([]);if(f){f(false)}}})}});return b});