define(["underscore","backbone","views/login/index.min","views/index.min","views/audios/index.min","views/friends/index.min","views/static.min","collections/audios/index.min","collections/users/users.min"],function(i,h,e,d,f,c,g,j,b){var a=h.Router.extend({routes:{"":"index",login:"loginAction",logout:"logoutAction","id_:id/audios/list":"audiosAction","id_:id/friends":"friendsAction","*path":"defaultAction"},_createBaseCollections:function(q){var o={friends:false,audio:false};if(q.friends){if(this.app.collections.friendsList){var l=this.app.collections.audioList.options;var n=i.extend({},l,q.friends);if(!l.user_id){l.user_id=n.user_id}if(!i.isEqual(l,n)){o.friends=true;this.app.collections.friendsList.options=n;this.app.collections.friendsList.loadData()}}else{o.friends=true;this.app.collections.friendsList=new b({user_id:q.friends.user_id})}}if(q.audio){if(this.app.collections.audioList){var p=this.app.collections.audioList.options;p.album_id=false;var r=i.extend({},p,q.audio);if(!p.user_id){p.user_id=r.user_id}if(!i.isEqual(p,r)){o.audio=true;this.app.collections.audioList.options=r;this.app.collections.audioList.loadData()}}else{o.audio=true;this.app.collections.audioList=new j({owner_id:q.audio.owner_id,album_id:false})}}if(q.audioFavorites){if(this.app.collections.audioFavorites){var m=this.app.collections.audioFavorites.options;var k=i.extend({},m,q.audioFavorites);if(!m.owner_id){m.owner_id=k.owner_id}if(!i.isEqual(m,k)){o.audioFavorites=true;this.app.collections.audioFavorites.options=k;this.app.collections.audioFavorites.loadData()}}else{o.audioFavorites=true;this.app.collections.audioFavorites=new j({owner_id:q.audioFavorites.owner_id,album_id:q.audioFavorites.album_id})}}return o},index:function(){if(!this.app.attributes.logined){return this.navigate("#/login",{trigger:true})}if(!this.app.views.index){this.app.views.index=new d()}this.navigate("#/id_"+this.app.attributes.mid+"/audios/list",{trigger:true})},audiosAction:function(m){if(!this.app.attributes.logined){return this.navigate("#/login",{trigger:true})}if(!this.app.views.index){this.app.views.index=new d()}var l={friends:{user_id:this.app.attributes.mid},audio:{owner_id:m},audioFavorites:{owner_id:this.app.attributes.mid,album_id:true}};var k=this._createBaseCollections(l);if(!this.view||this.view.name!=="AudiosIndexView"){this.view=new f({createCollections:k})}else{this.view.reload({childs:["appContentCol1"]})}},friendsAction:function(m){if(!this.app.attributes.logined){return this.navigate("#/login",{trigger:true})}if(!this.app.views.index){this.app.views.index=new d()}var l={friends:{user_id:m},audio:{owner_id:this.app.attributes.mid},audioFavorites:{owner_id:this.app.attributes.mid,album_id:true}};var k=this._createBaseCollections(l);if(!this.view||this.view.name!=="FriendsIndexView"){this.view=new c({createCollections:k})}else{console.log("reload")}},logoutAction:function(){VK.Auth.logout();this.navigate("login",{trigger:true})},loginAction:function(){if(this.view){this.view.remove()}if(this.app.views.index){this.app.views.index.remove();delete this.app.views.index}this.view=new e()},defaultAction:function(m){if(!this.app.attributes.logined){return this.navigate("#/login",{trigger:true})}var k={about:{tpl:"static/about.html",node:".appContentNode",navSelector:"#geAboutPage"}};if(!k[m]){return this.navigate("#/",{trigger:true})}if(!this.app.views.index){this.app.views.index=new d()}var l={friends:{user_id:this.app.attributes.mid},audio:{owner_id:this.app.attributes.mid},audioFavorites:{owner_id:this.app.attributes.mid,album_id:true}};this._createBaseCollections(l);this.view=new g(k[m]);this.app.log({msg:"router > "+m})}});return a});